{
  "filename": "debug.md",
  "__html": "<h1>问题排查手册</h1>\n<h2>一、概述</h2>\n<p>TxManager 和 TxClient 都支持日志记录到数据库（TXManager默认开启日志记录）。<br>\n日志记录格式：<br>\n<img src=\"../../img/t_logger.png\" alt=\"t_logger\"></p>\n<blockquote>\n<p>group_id: 分布式事务组标示<br>\nunit_id: 参与分布式事务的某个节点标示\ntag:日志分类\ncontent:日志内容\napp_name:日志分类（应用级）</p>\n</blockquote>\n<h2>二、在日志开启后的问题排查</h2>\n<h3>1、TxClient</h3>\n<ul>\n<li>事务组会话完整性检测</li>\n</ul>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">select</span> * <span class=\"hljs-keyword\">from</span> t_logger <span class=\"hljs-keyword\">where</span> t_logger.group_id = <span class=\"hljs-string\">'99937859659434961'</span>\n</code></pre>\n<p>整个DTX下，TxClient某个事务组内容如下完整日志日路如下：<br>\n<img src=\"../../img/tx_session.png\" alt=\"tx_session\"></p>\n<ul>\n<li>某个微服务某次事务会话</li>\n</ul>\n<pre><code class=\"language-sql\"><span class=\"hljs-keyword\">select</span> * \n<span class=\"hljs-keyword\">from</span> t_logger \n<span class=\"hljs-keyword\">where</span> t_logger.group_id = <span class=\"hljs-string\">'99937859659434961'</span> <span class=\"hljs-keyword\">and</span> app_name=<span class=\"hljs-string\">'spring-demo-d'</span>\n</code></pre>\n<ul>\n<li>其它。根据情况按日志字段查看日志记录</li>\n</ul>\n<h5>日志解读：</h5>\n<ul>\n<li>日志分类-应用:<br>\n若基于默认配置，即非单独分配日志数据库时，日志会分别存在于各业务数据库下。若集中存储日志时，则可以按此字段查找整个事务到某个模块下的信息</li>\n<li>日志分类-TAG:<br>\ntransaction: 事务信息<br>\ntask: 补偿任务信息<br>\ntxc: TXC模式事务信息<br>\nlcn: LCN模式事务信息<br>\ntcc: TCC模式事务信息</li>\n<li>日志内容:<br>\npre business code: 准备业务代码<br>\n[start]create group：创建分布式事务组<br>\ndo business code：执行业务代码<br>\nbusiness code success： 业务代码执行成功<br>\n[txc]write undo log 193： 记录回滚sql<br>\n[join]join group： 加入事务组<br>\n[join,task]start delay checking task：开始补偿任务<br>\n[start]notify group 1：通知事务组（提交/回滚）<br>\nclean transaction：清理事务<br>\n[txc]clear undo log：清理回滚sql<br>\n[join,task]stop delay checking task：关闭补偿任务<br>\nclean transaction over：事务清理成功</li>\n</ul>\n<h3>2、TxManager</h3>\n<p>TxManager 提供后台管理服务。<a href=\"manageradmin.html\">详情</a></p>\n",
  "link": "\\zh-cn\\docs\\debug.html",
  "meta": {}
}